name: Telegram Message
on:
  push:
    branches:
      - main
      - dev

jobs:
  build:
    name: Build
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      # Basic message
      - name: Send basic message
        uses: ./
        with:
          to: ${{ secrets.TELEGRAM_CHAT_ID }}
          token: ${{ secrets.TELEGRAM_BOT_TOKEN }}
          message: |
            ğŸš€ Push detected on ${{ github.repository }}

            ğŸ“ Commit: ${{ github.event.head_commit.message }}
            ğŸ‘¤ Author: ${{ github.actor }}
            ğŸ”— See: https://github.com/${{ github.repository }}/commit/${{ github.sha }}

      # Send to topic (forum)
      - name: Send to CI topic
        uses: ./
        with:
          to: ${{ secrets.TELEGRAM_CHAT_ID }}
          token: ${{ secrets.TELEGRAM_BOT_TOKEN }}
          message_thread_id: ${{ secrets.TELEGRAM_THREAD_ID }}
          format: markdown
          message: |
            âœ… *Build #${{ github.run_number }}* successful!

            ğŸ“¦ Repository: `${{ github.repository }}`
            ğŸ”€ Branch: `${{ github.ref_name }}`
            ğŸ“ Commit: `${{ github.sha }}`

      # Notification for dev branch push
      - name: Dev branch notification
        if: github.ref == 'refs/heads/dev'
        uses: ./
        with:
          to: ${{ secrets.TELEGRAM_CHAT_ID }}
          token: ${{ secrets.TELEGRAM_BOT_TOKEN }}
          message_thread_id: ${{ secrets.TELEGRAM_THREAD_ID }}
          format: markdown
          message: |
            ğŸ§ª *Dev Branch Update*

            ğŸ“¦ Repository: `${{ github.repository }}`
            ğŸ“ Commit: ${{ github.event.head_commit.message }}
            ğŸ‘¤ Author: `${{ github.actor }}`
            ğŸ”— [View Changes](https://github.com/${{ github.repository }}/commit/${{ github.sha }})

      # Default message (no custom message)
      - name: Send default message
        uses: ./
        with:
          to: ${{ secrets.TELEGRAM_CHAT_ID }}
          token: ${{ secrets.TELEGRAM_BOT_TOKEN }}

      # Disable link preview
      - name: Message without preview
        uses: ./
        with:
          to: ${{ secrets.TELEGRAM_CHAT_ID }}
          token: ${{ secrets.TELEGRAM_BOT_TOKEN }}
          disable_web_page_preview: true
          message: |
            Check out this link without preview: https://github.com

      # Silent notification
      - name: Silent notification
        uses: ./
        with:
          to: ${{ secrets.TELEGRAM_CHAT_ID }}
          token: ${{ secrets.TELEGRAM_BOT_TOKEN }}
          disable_notification: true
          message: |
            ğŸ”• This is a silent notification
